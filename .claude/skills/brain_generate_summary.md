# Skill: brain_generate_summary

**Tier:** Silver
**Type:** Reporting Skill
**Version:** 1.0.0
**Skill Number:** 21

## Purpose

Generate daily/weekly summaries of system activity, pending items, and metrics. Provides at-a-glance view of AI Employee operations and items requiring attention.

## Inputs

- **Time Period:** `--daily` or `--weekly`
- **Date:** Target date for summary (defaults to today)

## Outputs

- **Summary File:** Plans/Briefings/summary_{YYYY-MM-DD}.md
- **Dashboard Update:** Dashboard.md updated with latest summary link

## Preconditions

- system_log.md exists
- Logs/mcp_actions.log exists
- Plans/Briefings/ folder exists

## Approval Gate

**No** (read-only reporting skill)

## MCP Tools Used

None (analysis and reporting skill)

## Steps

### 1. Create Plans/Briefings/ if Missing

```powershell
New-Item -ItemType Directory -Path "Plans/Briefings" -Force -ErrorAction SilentlyContinue
```

### 2. Collect Data

#### 2.1 Parse system_log.md

```powershell
$logEntries = Get-Content "system_log.md" | Select-String -Pattern "^###.*{date}"
```

Extract today's/this week's entries

#### 2.2 Count Files

```powershell
$needsActionCount = (Get-ChildItem "Needs_Action/*.md").Count
$doneCount = (Get-ChildItem "Done/*.md").Count
$pendingApprovalCount = (Get-ChildItem "Pending_Approval/PLAN_*.md").Count
```

#### 2.3 Parse MCP Actions

```powershell
$mcpActions = Get-Content "Logs/mcp_actions.log" | Select-String -Pattern "{date}"
```

Count dry-run vs execute, success vs failure

#### 2.4 Calculate Metrics

```powershell
$totalProcessingTime = # Sum durations from logs
$successRate = # (successful ops / total ops) * 100
```

### 3. Generate Summary

Template:
```markdown
# Daily Summary - {YYYY-MM-DD}

**Generated:** {timestamp}
**Period:** {date} (00:00 - 23:59 UTC)

## Activity Overview

- **Intake Items Processed:** {count}
- **Tasks Completed:** {count}
- **MCP Actions Executed:** {count} ({dry_run_count} dry-run, {execute_count} executed)
- **Items Pending Approval:** {count}

## MCP Actions

### Successful Actions ({count})
- {tool}.{operation} - {timestamp}
- {tool}.{operation} - {timestamp}

### Failed Actions ({count})
{if any failures:}
- {tool}.{operation} - {timestamp} - Error: {error}
{else:}
- None

## Pending Attention

### Needs Action ({count})
- [Task 1](../Needs_Action/task1.md)
- [Task 2](../Needs_Action/task2.md)

### Pending Approval ({count})
- [Plan 1](../Pending_Approval/PLAN_1.md) - Risk: {level}
- [Plan 2](../Pending_Approval/PLAN_2.md) - Risk: {level}

## Metrics

- **Total Processing Time:** {duration}
- **Success Rate:** {percentage}%
- **Average Operation Duration:** {seconds}s

## System Health

- ✓ Filesystem watcher: Running
- ✓ Gmail watcher: Running ({email_count} emails processed)
- ✓ MCP server: Operational
- ✓ Scheduled tasks: On schedule

---

**Next Summary:** {tomorrow_date}
**Generated by:** brain_generate_summary (Skill 21)
```

### 4. Save Summary File

```powershell
$summary | Out-File -FilePath "Plans/Briefings/summary_{YYYY-MM-DD}.md" -Encoding UTF8
```

### 5. Update Dashboard.md

Update "Latest Summary" section:
```markdown
## Latest Summary

**Daily Summary:** [2026-02-11](Plans/Briefings/summary_2026-02-11.md)
**Generated:** {timestamp}

**Quick Stats:**
- Pending Approval: {count}
- Needs Action: {count}
- MCP Actions (24h): {count}
```

### 6. Log to system_log.md

```markdown
### {timestamp} - summary_generated
**Skill:** brain_generate_summary (Skill 21)
**Period:** {daily|weekly}
**File:** Plans/Briefings/summary_{date}.md

**Outcome:** ✓ OK - Summary generated
- Intake: {count}, Completed: {count}, MCP: {count}
```

## Failure Handling

### What to Do:
- If log files missing: Generate summary with available data, note missing sources
- If cannot write summary: Log error, display summary to console

### What NOT to Do:
- ❌ Do NOT generate empty summaries (show "No activity" if no data)
- ❌ Do NOT skip pending items section

## Logging Requirements

system_log.md entry for each summary generation

## Definition of Done

- [ ] Data collected from all sources
- [ ] Summary file created in Plans/Briefings/
- [ ] Dashboard.md updated with latest summary
- [ ] All counts accurate
- [ ] Metrics calculated correctly
- [ ] Pending items listed
- [ ] system_log.md entry created

## Test Procedure (Windows)

```powershell
# Generate daily summary
brain_generate_summary --daily

# Verify file created
Test-Path "Plans/Briefings/summary_$(Get-Date -Format 'yyyy-MM-dd').md"  # Returns True

# Verify content
Get-Content "Plans/Briefings/summary_*.md"

# Verify Dashboard updated
Select-String -Path "Dashboard.md" -Pattern "Latest Summary"

# Expected: Summary generated with all sections
```

## Integration

**Called By:** Scheduled task (daily at 6 PM) or manual invocation
**Calls:** None

## References

- Constitution: `Specs/sp.constitution.md` (Section 5: Reporting)
- Specification: `Specs/SPEC_silver_tier.md` (Section 7: Daily Summaries)

---

**Last Updated:** 2026-02-11
**Status:** Documented (M2 Complete)
